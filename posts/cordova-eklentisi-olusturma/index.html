<!doctype html><html lang=tr-tr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Cordova Eklentisi Oluşturma - Mazlum Özhan</title><meta name=description content="Bu yazı ile basit bir Cordova eklentisinin nasıl oluşturulacağı, ne olduğu ve ne zaman ihtiyaç duyduğumuzu anlatmaya çalışacağım.
Cordova Eklentisi Nedir? Başlamadan önce Cordova eklentilerinin ne olduğunu anlayalım. Cordova eklentisi web ve native sistem arasında köprü işlevi görür. Biraz JavaScript biraz da native kod ile bu görevi üstlenir.
Ne Zaman İhtiyaç Duyarız? Cordova uygulamaları temelde bir web tarayıcısında çalışır. Bununla birlikte web her zaman native sistemde ihtiyaç duyacağımız özellikleri sağlamaz. Bu sebeple native kod yazıp sistem ile iletişime geçmemiz gerekiyor."><meta name=author content><link rel="preload stylesheet" as=style href=https://mazlumozhan.dev/app.min.css><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-TTNS7R4');</script><link rel="preload stylesheet" as=style href=https://mazlumozhan.dev/an-old-hope.min.css><script defer src=https://mazlumozhan.dev/highlight.min.js onload=hljs.initHighlightingOnLoad();></script><link rel=preload as=image href=https://mazlumozhan.dev/theme.png><link rel=preload as=image href=https://mazlumozhan.dev/github.svg><link rel=icon href=https://mazlumozhan.dev/favicon.ico><link rel=apple-touch-icon href=https://mazlumozhan.dev/apple-touch-icon.png><meta name=generator content="Hugo 0.79.1"><meta property="og:title" content="Cordova Eklentisi Oluşturma"><meta property="og:description" content="Bu yazı ile basit bir Cordova eklentisinin nasıl oluşturulacağı, ne olduğu ve ne zaman ihtiyaç duyduğumuzu anlatmaya çalışacağım.
Cordova Eklentisi Nedir? Başlamadan önce Cordova eklentilerinin ne olduğunu anlayalım. Cordova eklentisi web ve native sistem arasında köprü işlevi görür. Biraz JavaScript biraz da native kod ile bu görevi üstlenir.
Ne Zaman İhtiyaç Duyarız? Cordova uygulamaları temelde bir web tarayıcısında çalışır. Bununla birlikte web her zaman native sistemde ihtiyaç duyacağımız özellikleri sağlamaz. Bu sebeple native kod yazıp sistem ile iletişime geçmemiz gerekiyor."><meta property="og:type" content="article"><meta property="og:url" content="https://mazlumozhan.dev/posts/cordova-eklentisi-olusturma/"><meta property="article:published_time" content="2021-08-30T21:26:18+03:00"><meta property="article:modified_time" content="2021-08-30T21:26:18+03:00"><meta itemprop=name content="Cordova Eklentisi Oluşturma"><meta itemprop=description content="Bu yazı ile basit bir Cordova eklentisinin nasıl oluşturulacağı, ne olduğu ve ne zaman ihtiyaç duyduğumuzu anlatmaya çalışacağım.
Cordova Eklentisi Nedir? Başlamadan önce Cordova eklentilerinin ne olduğunu anlayalım. Cordova eklentisi web ve native sistem arasında köprü işlevi görür. Biraz JavaScript biraz da native kod ile bu görevi üstlenir.
Ne Zaman İhtiyaç Duyarız? Cordova uygulamaları temelde bir web tarayıcısında çalışır. Bununla birlikte web her zaman native sistemde ihtiyaç duyacağımız özellikleri sağlamaz. Bu sebeple native kod yazıp sistem ile iletişime geçmemiz gerekiyor."><meta itemprop=datePublished content="2021-08-30T21:26:18+03:00"><meta itemprop=dateModified content="2021-08-30T21:26:18+03:00"><meta itemprop=wordCount content="609"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Cordova Eklentisi Oluşturma"><meta name=twitter:description content="Bu yazı ile basit bir Cordova eklentisinin nasıl oluşturulacağı, ne olduğu ve ne zaman ihtiyaç duyduğumuzu anlatmaya çalışacağım.
Cordova Eklentisi Nedir? Başlamadan önce Cordova eklentilerinin ne olduğunu anlayalım. Cordova eklentisi web ve native sistem arasında köprü işlevi görür. Biraz JavaScript biraz da native kod ile bu görevi üstlenir.
Ne Zaman İhtiyaç Duyarız? Cordova uygulamaları temelde bir web tarayıcısında çalışır. Bununla birlikte web her zaman native sistemde ihtiyaç duyacağımız özellikleri sağlamaz. Bu sebeple native kod yazıp sistem ile iletişime geçmemiz gerekiyor."></head><body class=not-ready data-menu=true><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TTNS7R4" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><header class=header><p class=logo><a class=site-name href=https://mazlumozhan.dev/>Mazlum Özhan</a><a class=btn-dark></a></p><script>let bodyClx=document.body.classList;let btnDark=document.querySelector('.btn-dark');let sysDark=window.matchMedia('(prefers-color-scheme: dark)');let darkVal=localStorage.getItem('dark');let setDark=(isDark)=>{bodyClx[isDark?'add':'remove']('dark');localStorage.setItem('dark',isDark?'yes':'no');};setDark(darkVal?darkVal==='yes':sysDark.matches);requestAnimationFrame(()=>bodyClx.remove('not-ready'));btnDark.addEventListener('click',()=>setDark(!bodyClx.contains('dark')));sysDark.addEventListener('change',(event)=>setDark(event.matches));</script><nav class=menu><a href=/>Blog</a>
<a href=/about/>Hakkımda</a></nav><nav class=social><a class=github style="--url: url(./github.svg)" href=https://github.com/mozhn target=_blank></a></nav></header><main class=main><article class=post-single><header class=post-title><aside><time>August 30, 2021</time></aside><h1>Cordova Eklentisi Oluşturma</h1></header><section class=post-content><p><img src=/img/cordova-plugin.png alt="Cordova eklentisi"></p><p>Bu yazı ile basit bir Cordova eklentisinin nasıl oluşturulacağı, ne olduğu ve ne zaman ihtiyaç duyduğumuzu anlatmaya çalışacağım.</p><h3 id=cordova-eklentisi-nedir>Cordova Eklentisi Nedir?</h3><p>Başlamadan önce Cordova eklentilerinin ne olduğunu anlayalım. Cordova eklentisi web ve native sistem arasında köprü işlevi görür. Biraz JavaScript biraz da native kod ile bu görevi üstlenir.</p><h3 id=ne-zaman-ihtiyaç-duyarız>Ne Zaman İhtiyaç Duyarız?</h3><p>Cordova uygulamaları temelde bir web tarayıcısında çalışır. Bununla birlikte web her zaman native sistemde ihtiyaç duyacağımız özellikleri sağlamaz. Bu sebeple native kod yazıp sistem ile iletişime geçmemiz gerekiyor. Cordova eklentisi bunu sağlar.</p><h3 id=nasıl-oluşturulur>Nasıl Oluşturulur?</h3><p>Eklenti oluşturmak için öncelikle Cordova CLI ve Plugman&rsquo;a ihtiyacımız var. Aşağıdaki komut ile terminalden kurulum yapabilirsiniz.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>npm install -g plugman cordova</code></pre></div><p>Ardından Plugman aracılığıyla eklentiyi oluşturabiliriz. Toplam 3 parametre belirtmemiz gerekiyor.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>plugman create --name PluginName --plugin_id &#34;me.mazlum.pluginname&#34; --plugin_version 0.0.1</code></pre></div><p>Komutu çalıştırdıktan sonra bulunduğunuz dizinde pluginin temel klasör ve dosyalarını oluşturacaktır. Daha sonra oluşturulan klasörün içerisine girip aşağıdaki komut ile plugine platform ekleyebiliriz. Örneğin android üzerinden gidelim.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>plugman platform add --platform_name android</code></pre></div><p>Yukarıdaki komut çalıştırıldıktan sonra örnek bir Java dosyanız oluşacak. Android platformu için yazacağınız tüm kodlar bu dosya üzerinden yönetilecek. Buraya kadar geldiğiniz durumda aslında elinizde çok basit bir eklenti oluyor. Eğer bu eklentiyi NPM ile yayınlamak isterseniz, aşağıdaki komut ile package.json dosyasını oluşturabilirsiniz.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>plugman createpackagejson .</code></pre></div><blockquote><p>Bu kısım itibariyle örnekler Android üzerine olacak.</p></blockquote><h3 id=javascript-api>JavaScript API</h3><p>Yazının başlangıcında bahsettiğim gibi biraz JavaScript biraz da native kod demiştik. İlk önce JavaScript tarafında çalışacağımız kısma bir göz atalım. Aşağıdaki dosyaya <strong>www/PluginName.js</strong> dizininden ulaşabilirsiniz.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>exec</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;cordova/exec&#39;</span>);
<span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>coolMethod</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>arg0</span>, <span style=color:#a6e22e>success</span>, <span style=color:#a6e22e>error</span>) {
  <span style=color:#a6e22e>exec</span>(<span style=color:#a6e22e>success</span>, <span style=color:#a6e22e>error</span>, <span style=color:#e6db74>&#39;PluginName&#39;</span>, <span style=color:#e6db74>&#39;coolMethod&#39;</span>, [<span style=color:#a6e22e>arg0</span>]);
};
</code></pre></div><p>Bu dosyada oluşturulan fonksiyonlar aracılığıyla native kod ile iletişim kuracağız. Örneğin JavaScript tarafında bu fonksiyonu aşağıdaki şekilde çağırabiliriz.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#a6e22e>cordova</span>.<span style=color:#a6e22e>plugins</span>.<span style=color:#a6e22e>PluginName</span>.<span style=color:#a6e22e>coolMethod</span>(<span style=color:#e6db74>&#39;test&#39;</span>, (<span style=color:#a6e22e>success</span>) =&gt; {
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;response&#39;</span>, <span style=color:#a6e22e>success</span>);
});
</code></pre></div><p>Bir de bunun native taraftaki karşılığına bakalım. Aşağıdaki dosyaya <strong>src/android/PluginName.java</strong> dizininden ulaşabilirsiniz.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=color:#f92672>package</span> me.mazlum.pluginname<span style=color:#f92672>;</span>
<span style=color:#f92672>import</span> org.apache.cordova.CordovaPlugin<span style=color:#f92672>;</span>
<span style=color:#f92672>import</span> org.apache.cordova.CallbackContext<span style=color:#f92672>;</span>
<span style=color:#f92672>import</span> org.json.JSONArray<span style=color:#f92672>;</span>
<span style=color:#f92672>import</span> org.json.JSONException<span style=color:#f92672>;</span>
<span style=color:#f92672>import</span> org.json.JSONObject<span style=color:#f92672>;</span>

<span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PluginName</span> <span style=color:#66d9ef>extends</span> CordovaPlugin <span style=color:#f92672>{</span>
  <span style=color:#a6e22e>@Override</span>
  <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>boolean</span> <span style=color:#a6e22e>execute</span><span style=color:#f92672>(</span>String action<span style=color:#f92672>,</span> JSONArray args<span style=color:#f92672>,</span> CallbackContext callbackContext<span style=color:#f92672>)</span> <span style=color:#66d9ef>throws</span> JSONException <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>action<span style=color:#f92672>.</span><span style=color:#a6e22e>equals</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;coolMethod&#34;</span><span style=color:#f92672>))</span> <span style=color:#f92672>{</span>
      String message <span style=color:#f92672>=</span> args<span style=color:#f92672>.</span><span style=color:#a6e22e>getString</span><span style=color:#f92672>(</span>0<span style=color:#f92672>);</span>
      <span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>coolMethod</span><span style=color:#f92672>(</span>message<span style=color:#f92672>,</span> callbackContext<span style=color:#f92672>);</span>
      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span><span style=color:#f92672>;</span>
    <span style=color:#f92672>}</span>

    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span><span style=color:#f92672>;</span>
  <span style=color:#f92672>}</span>

  <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>coolMethod</span><span style=color:#f92672>(</span>String message<span style=color:#f92672>,</span> CallbackContext callbackContext<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
    <span style=color:#66d9ef>if</span> <span style=color:#f92672>(</span>message <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> message<span style=color:#f92672>.</span><span style=color:#a6e22e>length</span><span style=color:#f92672>()</span> <span style=color:#f92672>&gt;</span> 0<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
      callbackContext<span style=color:#f92672>.</span><span style=color:#a6e22e>success</span><span style=color:#f92672>(</span>message<span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span> <span style=color:#66d9ef>else</span> <span style=color:#f92672>{</span>
      callbackContext<span style=color:#f92672>.</span><span style=color:#a6e22e>error</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Expected one non-empty string argument.&#34;</span><span style=color:#f92672>);</span>
    <span style=color:#f92672>}</span>
<span style=color:#f92672>}</span></code></pre></div><p><strong>execute</strong> adlı metot aracılığıyla JavaScript tarafından gönderilen parametreleri yakalayıp işliyoruz. Yukarıdaki örnekte <strong>coolMethod</strong> güzel bir örnek.</p><h3 id=eklentiye-dependency-ekleme>Eklentiye Dependency Ekleme</h3><p>Plugin oluşturduktan sonra elbet başka bir pakete ihtiyacınız olacaktır. Peki bu durumda Cordova eklentinize nasıl paket ekleyeceksiniz? Yapmamız gereken işlem basit. CLI ile eklentiyi oluştururken <strong>plugin.xml</strong> adında bir dosya da oluşturuldu. Bu dosya içerisine paketlerimizi ekleyebiliriz. Örneğin Agora Voice SDK import edelim.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;platform</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;android&#34;</span><span style=color:#f92672>&gt;</span>
  ....
  <span style=color:#f92672>&lt;framework</span> <span style=color:#a6e22e>src=</span><span style=color:#e6db74>&#34;io.agora.rtc:voice-sdk:3.3.0&#34;</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#f92672>&lt;/platform&gt;</span></code></pre></div><h3 id=eklentiye-permission-ekleme>Eklentiye Permission Ekleme</h3><p>Örneğin mikrofon izinine ihtiyacımız olacak bu SDK&rsquo;i kullanırken. O zaman eklenti kurulduğunda, <strong>AndroidManifest.xml</strong> dosyamıza bu izini aşağıdaki kod ile otomatik eklemesini sağlayalım. Yine <strong>plugin.xml</strong> dosyamızda düzenleme yapmalıyız.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;platform</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;android&#34;</span><span style=color:#f92672>&gt;</span>
  ....
  <span style=color:#f92672>&lt;config-file</span> <span style=color:#a6e22e>parent=</span><span style=color:#e6db74>&#34;/manifest&#34;</span> <span style=color:#a6e22e>target=</span><span style=color:#e6db74>&#34;AndroidManifest.xml&#34;</span><span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;uses-permission</span> <span style=color:#a6e22e>android:name=</span><span style=color:#e6db74>&#34;android.permission.RECORD_AUDIO&#34;</span> <span style=color:#f92672>/&gt;</span>
  <span style=color:#f92672>&lt;/config-file&gt;</span>
<span style=color:#f92672>&lt;/platform&gt;</span></code></pre></div><h3 id=eklentiye-değişkenler-ekleme>Eklentiye Değişkenler Ekleme</h3><p>Bir eklentiyi kurarken sabit bir değişken isteyebiliriz. Bu değişkenler platform özelinde veya direkt genel olabilir. Örneğin <strong>cordova-plugin-purchase</strong> eklentisini kurarken <strong>BILLING_KEY</strong> adında bir değişken vermeniz gerekir. Parametre ile eklenti kurulumuna bir örnek.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>cordova plugin add cordova-plugin-purchase --variable BILLING_KEY=&#34;MIIB...AQAB&#34;</code></pre></div><p>Peki bu değişkeni nerede tanımlıyoruz? Evet yine <strong>plugin.xml</strong>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#f92672>&lt;preference</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;MY_GLOBAL_VARIABLE&#34;</span> <span style=color:#a6e22e>default=</span><span style=color:#e6db74>&#34; &#34;</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#f92672>&lt;platform</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;android&#34;</span><span style=color:#f92672>&gt;</span>
  ....
  <span style=color:#f92672>&lt;preference</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;MY_VARIABLE&#34;</span> <span style=color:#a6e22e>default=</span><span style=color:#e6db74>&#34; &#34;</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#f92672>&lt;/platform&gt;</span></code></pre></div><h3 id=eklentinin-bir-projeye-kurulması>Eklentinin Bir Projeye Kurulması</h3><p>Eklentimizi oluşturduk, paketlerimizi ekledik, değişkenlerimizi tanımladık. Artık bu eklentiyi bir cordova projesinde kullanmaya hazırız. Eğer eklentiyi henüz NPM&rsquo;de yayınlamadıysanız aşağıdaki şekilde cordova projenize ekleyebilirsiniz. Cordova projenizin ana dizinine gidip aşağıdaki komut ile eklentinizi projenize ekleyebilirsiniz.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>cordova plugin add --link ~/path/PluginName</code></pre></div><p>Artık bu aşamadan sonra dilediğiniz şekilde native kodda düzenleme yapabilirsiniz.</p><h3 id=son>Son</h3><p>Bu yazı ile birlikte küçük bir Cordova eklentisi oluşturmayı ve ufak tefek özelleştirme yapmayı öğrendik. Bir sonraki yazımda görüşmek üzere.</p></section></article></main><footer class=footer><p>&copy; 2021 <a href=https://mazlumozhan.dev/>Mazlum Özhan</a></p><p>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>️</p><p><a href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>Paper 5.0</a></p></footer></body></html>